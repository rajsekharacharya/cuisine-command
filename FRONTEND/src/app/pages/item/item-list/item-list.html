<div class="body-area-content">
  <div class="table-container">
    <table class="table-view">
      <tr class="table-head-primary" style=" cursor: pointer;">
        <th class="col-sl">#</th>
        <th (click)="changeSort('name')" (keydown)="handleKeyDown($event)" [class.sort-active]="sortField === 'name'">
          Name</th>
        <th (click)="changeSort('categoryName')" (keydown)="handleKeyDown($event)"
          [class.sort-active]="sortField === 'categoryName'">
          Category</th>
        <th>Dietary</th>
        <th>Status</th>
        <th class="col-action">Action</th>
      </tr>
      @if (loading) {
      @for (row of loaderRows; track $index) {
      <tr>
        @for (cell of loaderCells; track $index) {
        <td>
          <div class="loader-mask" [class.action]="$index === loaderCells.length - 1"></div>
        </td>
        }
        <td>
          <div class="loader-mask action"></div>
        </td>
      </tr>
      }
      }
      @else if (!loading && items.length === 0) {
      <tr>
        <td colspan="7" class="text-center">
          No records to display
        </td>
      </tr>
      }
      @else {
      @for (item of items; track $index) {
      <tr>
        <td class="col-sl">{{ $index + 1 }}</td>
        <td>{{ item.name }}</td>
        <td>{{ item.categoryName }}</td>
        <td>{{ item.dietary }}</td>
        <td>{{ item.status ? 'Active' : 'Inactive' }}</td>
        <td class="col-action">
          <div class="dropdown">
            <button class="btn btn-icon btn-option" type="button" id="dropdownMenuButton{{ item.id }}"
              data-bs-toggle="dropdown" aria-expanded="false" [disabled]="loading">
              <span class="icon-common icon-option icon-btn-circle"></span>
            </button>
            <ul class="dropdown-menu" [attr.aria-labelledby]="'dropdownMenuButton' + item.id">
              <li>
                <a class="dropdown-item" (click)="editItem(item)">
                  <span class="icon-common icon-dropdown icon-edit"></span>
                  <span class="lbl-action lbl-edit">Edit</span>
                </a>
              </li>
              <li>
                <a class="dropdown-item" (click)="setItemToToggle(item.id)" data-bs-toggle="modal"
                  data-bs-target="#itemToggleConfirmation" #triggerButton>
                  <span class="icon-common icon-dropdown icon-trash"></span>
                  <span class="lbl-action lbl-delete">Toggle Status</span>
                </a>
              </li>
            </ul>
          </div>
        </td>
      </tr>
      }
      }
    </table>
  </div>

  <div class="pagination-container">
    <nav aria-label="Page navigation example">
      <ul class="pagination justify-content-center align-items-center">
        <!-- First Page -->
        <li class="page-item" [class.disabled]="currentPage === 0">
          <a class="page-link" (click)="goToPage(0)" aria-label="First">
            <i class="bi bi-chevron-double-left"></i>
          </a>
        </li>

        <!-- Previous Page -->
        <li class="page-item" [class.disabled]="currentPage === 0">
          <a class="page-link" (click)="goToPage(currentPage - 1)" aria-label="Previous">
            <i class="bi bi-chevron-left"></i>
          </a>
        </li>

        <!-- Page Numbers (Dynamic, e.g., limited to 3-5 visible) -->
        <ng-container *ngFor="let page of getPageNumbers()">
          <li class="page-item" [class.active]="currentPage === page">
            <a class="page-link" (click)="goToPage(page)">{{ page + 1 }}</a>
          </li>
        </ng-container>

        <!-- Total Pages Display -->
        <li class="page-item total-pages">
          <span class="page-link">of {{ totalPages }}</span>
        </li>

        <!-- Next Page -->
        <li class="page-item" [class.disabled]="currentPage === totalPages - 1">
          <a class="page-link" (click)="goToPage(currentPage + 1)" aria-label="Next">
            <i class="bi bi-chevron-right"></i>
          </a>
        </li>

        <!-- Last Page -->
        <li class="page-item" [class.disabled]="currentPage === totalPages - 1">
          <a class="page-link" (click)="goToPage(totalPages - 1)" aria-label="Last">
            <i class="bi bi-chevron-double-right"></i>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</div>

<!-- Toggle Status Confirmation Modal -->
<div class="modal fade modal-delete-confimation" data-bs-backdrop="static" data-bs-keyboard="false"
  id="itemToggleConfirmation" tabindex="-1" aria-labelledby="itemToggleConfirmation" appTeleportModal
  #itemToggleConfirmation>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content overflow-hidden">
      <div class="modal-close">
        <button type="button" class="btn-close" (click)="closeModal('itemToggleConfirmation')">
          <span class="icon-common icon-cross"></span>
        </button>
      </div>
      <div class="modal-body">
        <img src="/images/img-delete.svg" alt="" class="img-delete-confirmation">
        <div class="lbl-confirmation">Toggle Item Status?</div>
        <div class="lbl-warning"><span>Are you sure you want to toggle the status of this item? <br> This will
          </span><span class="lbl-danger">change its visibility</span><span>.</span></div>
      </div>
      <div class="modal-footer">
        <button class="btn-common btn-confirm btn-modal-action" [disabled]="loading" (click)="toggleStatus()">
          {{ loading ? 'Toggling...' : 'Yes, Toggle it' }}
        </button>
        <button class="btn-common btn-cancel btn-modal-action"
          (click)="closeModal('itemToggleConfirmation')">Cancel</button>
      </div>
    </div>
  </div>
</div>
